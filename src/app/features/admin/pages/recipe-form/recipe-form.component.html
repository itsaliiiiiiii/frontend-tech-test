<div class="page-header mb-8">
  <h1>{{ isEditMode ? 'Edit Recipe' : 'Add Recipe' }}</h1>
</div>

<form [formGroup]="recipeForm" (ngSubmit)="onSubmit()" class="recipe-form">
  
  <div class="form-section">
    <h3>Basic Information</h3>
    <div class="grid-2">
      <mat-form-field appearance="outline">
        <mat-label>Title</mat-label>
        <input matInput formControlName="title" placeholder="e.g. Spicy Chicken Wings">
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Category</mat-label>
        <input matInput formControlName="category" placeholder="e.g. Lunch">
      </mat-form-field>
    </div>

    <div class="grid-2">
      <mat-form-field appearance="outline">
        <mat-label>Image URL</mat-label>
        <input matInput formControlName="image" placeholder="https://...">
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Author</mat-label>
        <input matInput formControlName="author">
      </mat-form-field>
    </div>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Description</mat-label>
      <textarea matInput formControlName="description" rows="4"></textarea>
    </mat-form-field>

    <div class="grid-3">
      <mat-form-field appearance="outline">
        <mat-label>Prep Time (min)</mat-label>
        <input matInput type="number" formControlName="prepTime">
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Cook Time (min)</mat-label>
        <input matInput type="number" formControlName="cookTime">
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Servings</mat-label>
        <input matInput type="number" formControlName="servings">
      </mat-form-field>
    </div>
  </div>

  <div class="form-section" formGroupName="nutrition">
    <h3>Nutrition</h3>
    <div class="grid-5">
      <mat-form-field appearance="outline">
        <mat-label>Calories</mat-label>
        <input matInput type="number" formControlName="calories">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Fat (g)</mat-label>
        <input matInput type="number" formControlName="totalFat">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Protein (g)</mat-label>
        <input matInput type="number" formControlName="protein">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Carbs (g)</mat-label>
        <input matInput type="number" formControlName="carbohydrate">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Cholesterol (mg)</mat-label>
        <input matInput type="number" formControlName="cholesterol">
      </mat-form-field>
    </div>
  </div>

  <!-- Ingredients & Directions skipped for brevity in this iteration, 
       users can manage JSON directly or we assume simple editor. 
       Adding a simple JSON editor for complex arrays or just leaving them as is for now. 
       Let's add a simple implementation for Ingredients as a text area (one per line) for simplicity 
       to convert to array, or just use FormArray if I have time. 
       Let's use FormArray for Ingredients. -->

  <div class="form-section">
    <div class="flex justify-between items-center mb-4">
      <h3>Ingredients</h3>
      <button type="button" mat-button color="primary" (click)="addIngredient()">+ Add Ingredient</button>
    </div>
    
    <div formArrayName="ingredients">
      <div *ngFor="let ing of ingredients.controls; let i=index" [formGroupName]="i" class="flex gap-2 items-center mb-2">
        <mat-form-field appearance="outline" class="flex-1">
          <mat-label>Name</mat-label>
          <input matInput formControlName="name">
        </mat-form-field>
        <button type="button" mat-icon-button color="warn" (click)="removeIngredient(i)">
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>
  </div>

  <div class="form-actions flex gap-4 justify-end mt-8">
    <button type="button" mat-button routerLink="/admin/recipes">Cancel</button>
    <button type="submit" mat-flat-button color="primary" [disabled]="recipeForm.invalid">
      {{ isEditMode ? 'Update Recipe' : 'Create Recipe' }}
    </button>
  </div>
</form>
